<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
	<title>Yammer</title>
  
  <!-- Stylesheets -->
	<link rel="stylesheet" href="pure.css">
  <link rel="stylesheet" href="style.css">

</head>
<body>

<!-- Header -->
<header class="site-header">
  <div class="logo">
    <div class="pure-menu">
        <a class="pure-menu-heading">YAMMER</a>
    </div>
  </div>
</header>

<!-- Sidebar  -->
<div class="sidebar">
  <div class="pure-menu pure-menu-open">
      <a class="pure-menu-heading">YAMMER</a>
      <ul>
          <li><a href="#">Flickr</a></li>
          <li><a href="#">Messenger</a></li>
          <li><a href="#">Sports</a></li>
          <li><a href="#">Finance</a></li>
          <li class="pure-menu-heading">More Sites!</li>
          <li><a href="#">Games</a></li>
          <li><a href="#">News</a></li>
          <li><a href="#">OMG!</a></li>
      </ul>
  </div>
</div>


<div class="container">
  <div class="pure-g">

    <!-- Jumpbar -->
    <div class="pure-u-1-8 jumpbar">
      <ul>
        <li class="active">Inbox</li>
        <li>Core Services</li>
        <li>Clie√±ts Team</li>
        <li>Rails Team</li>
        <li>Off Topic but Rad</li>
      </ul>
    </div>
    
    <!-- Main content -->
    <div class="content-wrapper pure-u-3-4">
      <div class="content">


      </div>
    </div>
    <!-- Offset -->
    <div class="pure-u-1-8"></div>
  </div>

</div>

<!-- Scripts here -->
<script src="js/jquery-2.0.3.js"></script>
<script src="js/masonry.js"></script>
<script src="js/mustache.js"></script>

<script data-main="js/yamSauceApp" src="js/require.js"></script>
<script src="js/test.js"></script>
<script>

  // TODO: In prime time, put these in document.ready so they
  // remain private / don't pollute the namespace.
  var msnry;

  // Document ready stuff
  $(document).ready(function() {
    //
    // TEMPLATING (should be done before any other DOM-related stuff)
    //

    // Templates and Context (Change here when not testing)
    var message_template = $("#message-template").html();
    var message_context = test_messages

    // MESSAGES
    $(".content").html(Mustache.render(message_template, message_context));


    //
    // GET MASONRY GOIN'
    //
    var container = document.querySelector('.content');

    msnry = new Masonry( container, {
      columnWidth: '.message-wrapper',
      itemSelector: '.message-wrapper'
    });


    //
    // EVENT LISTENERS
    // 

    // WHEN YOU CLICK THINNGS THEY GET FOCUSED. HOT DOG!
    $(".message").click(function() {
      if($(this).parent().hasClass("active"))
        return;

      var shadow = $("<div />").addClass("shadowbox").click(function(){
        msnry.unstamp($(".message-wrapper").toArray());
        $(".message-wrapper").removeClass("active");
        $(this).remove();
        msnry.layout();
      });

      $("body").append(shadow);
      $(this).parent().addClass("active").siblings().removeClass("active");
      msnry.stamp($(this).parent()[0]);
    });


    // WHEN YOU HOVER OVER THE YAMMER THING IT BRINGS DA MENU IN.
    $(".sidebar").css("margin-left","-350px");
    $(".logo").hover(function() {
      $(".sidebar").animate({marginLeft: 0}, 100);
    });

    $(".sidebar").hover(function(){}, function(){
      $(".sidebar").animate({marginLeft: -350}, 100);
    });

  });

</script>


<!-- TEMPLATES FOR EVERYONE -->

<script id="message-template" type="text/x-mustache-template">

  {{#messages}}
  <div class='message-wrapper'>
    <div class='message'>
      <header>
        <div class='header-row'>
          <div class='avatar'>
            <img src='{{{avatar}}}' />
          </div>
          <div class='to-from'>
            {{from}}<br><span>to {{to}}</span>
          </div>
        </div>  
        <div class='timestamp'>{{timestamp}}</div>
      </header>
      <div class='content'>
        {{content}} 
      </div>
      <footer>
        <div class='meta'>{{likes}} Likes - 5 Comments</div>
      </footer>
    </div>
  </div>
  {{/messages}}
</script>

</body>
</html>